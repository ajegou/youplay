#!/bin/bash

player='omxplayer' # default valid for pi

conf_file=~/.play.conf
[[ -f $conf_file ]] && source $conf_file

if [[ "$1" == "--autoplay" ]]; then
  autoplay="$1"
  shift
fi

src=$*

title=$(youtube-dl -e "$src")
echo -e "Playing: $title ($src)"

[[ "$record_history" == "true" ]] && echo -e "$(date '+%s\t%Y-%m-%d %H:%M:%S')\t$src\t$title" >> "$history_file"

# play
[[ "$audio_only" == "true" ]] && format="bestaudio" || format="best"
url=$(youtube-dl -g -f $format "$src")
${player} "$url" > /dev/null 2>&1
yousearch $autoplay $src
